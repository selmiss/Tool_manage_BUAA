import{_ as g,d as c,E as h,c as i,e as t,n as f,f as d,v as m,g as p,b as u,t as _,o as a,p as b,i as w}from"./index-CIIbYJoP.js";const y={name:"login-register",data(){return{isLogin:!0,stateReg:!1,emailError:!1,passwordError:!1,existed:!1,form:{name:"",sid:"",college:"",email:"",password:"",code:"",phone:""},show:!0,count:"",timer:null}},methods:{sendCode(){this.timer||(console.log("已发送"),c({method:"post",url:"user/forget/sendCode",data:{acc:this.form.phone}}).then(e=>{console.log(e.data.error_code),alert("验证码已发送，请在手机信息中查看。")}),this.count=60,this.show=!1,this.timer=setInterval(()=>{this.count>0&&this.count<=60?this.count--:(this.show=!0,clearInterval(this.timer),this.timer=null)},1e3))},studentForgetPwd(){this.$router.push("/studentForgetPwd")},changeType(){this.isLogin=!this.isLogin,this.stateReg=!1,this.form.sid="",this.form.name="",this.form.college="",this.form.email="",this.form.password=""},teacherEntry(){this.$router.push("/teacherLogin")},changeRegState(){this.form.sid!=""&&this.form.name!=""&&this.form.college!=""?this.stateReg=!this.stateReg:alert("填写不能为空！")},login(){localStorage.setItem("token","wutoken");var r=localStorage.getItem("token");console.log(r),console.log(this.form.email+" : "+this.form.password),this.form.email!=""&&this.form.password!=""?c({method:"post",url:"user/login",data:{acc:this.form.email,pwd:this.form.password}}).then(e=>{e.data.error_code==0?(console.log(e.data.hash_code),print(e.data),localStorage.setItem("uid",e.data.uid),localStorage.setItem("Mail",this.form.email),localStorage.setItem("token",e.data.hash_code),this.$router.push("/borrowRecord")):e.data.error_code==1?alert("输入有误！请重新登录。"):e.data.error_code==2?alert("请先进行注册！"):e.data.error_code==3&&alert("密码错误！请重新输入")}).catch(e=>{console.log(e)}):alert("填写不能为空！")},register(){if(this.form.password!=""&&this.form.email!=""){let r=new FormData;r.append("studentId",this.form.sid),r.append("name",this.form.name),r.append("college",this.form.college),r.append("email",this.form.email),r.append("password",this.form.password),r.append("phone",this.form.phone),c({method:"post",url:"user/register",data:r}).then(e=>{h.success(e.data.msg),this.reload()}).catch(e=>{h.error(e.response.data.msg)})}else alert("填写不能为空！")}}},n=r=>(b("data-v-975f6a26"),r=r(),w(),r),v={class:"login-register"},k={class:"contain"},C={key:0,class:"big-contain"},E=n(()=>t("div",{class:"btitle"},"学生登录",-1)),T={class:"bform"},I={key:0,class:"errTips"},S={key:1,class:"errTips"},x={key:1,class:"big-contain"},U={key:0},V=n(()=>t("div",{class:"btitle"},"学生注册",-1)),R={class:"bform"},L=n(()=>t("br",null,null,-1)),M={key:0,class:"errTips"},N=n(()=>t("br",null,null,-1)),F=n(()=>t("br",null,null,-1)),P=n(()=>t("br",null,null,-1)),B={key:1},D={class:"btitle"},O={class:"bform"},z=n(()=>t("br",null,null,-1)),j=n(()=>t("br",null,null,-1)),q={key:0,class:"small-contain"},A=n(()=>t("div",{class:"stitle"},[u("北航工程训练中心"),t("br"),u("工具信息平台")],-1)),G=n(()=>t("p",{class:"scontent"},"尚无账号？点击下方按钮进行注册。",-1)),H=n(()=>t("br",null,null,-1)),J={key:1,class:"small-contain"},K=n(()=>t("div",{class:"stitle"},"学生，您好！",-1)),Q=n(()=>t("p",{class:"scontent"},[u("注册工训中心账号，"),t("br"),u("轻松进行设备借还。")],-1)),W=n(()=>t("br",null,null,-1));function X(r,e,Y,Z,o,l){return a(),i("div",v,[t("div",k,[t("div",{class:f(["big-box",{active:o.isLogin}])},[o.isLogin?(a(),i("div",C,[E,t("div",T,[d(t("input",{type:"email",placeholder:"邮箱","onUpdate:modelValue":e[0]||(e[0]=s=>o.form.email=s)},null,512),[[m,o.form.email]]),o.emailError?(a(),i("span",I,"* 邮箱填写错误 *")):p("",!0),d(t("input",{type:"password",placeholder:"密码","onUpdate:modelValue":e[1]||(e[1]=s=>o.form.password=s)},null,512),[[m,o.form.password]]),o.emailError?(a(),i("span",S,"* 密码填写错误 *")):p("",!0)]),t("button",{class:"bbutton",onClick:e[2]||(e[2]=(...s)=>l.login&&l.login(...s))},"登录"),u("   "),t("button",{onClick:e[3]||(e[3]=(...s)=>l.studentForgetPwd&&l.studentForgetPwd(...s))},"忘记密码")])):(a(),i("div",x,[o.stateReg?(a(),i("div",B,[t("div",D,"欢迎！"+_(this.form.name),1),t("div",O,[d(t("input",{type:"text",placeholder:"手机号码","onUpdate:modelValue":e[9]||(e[9]=s=>o.form.phone=s)},null,512),[[m,o.form.phone]]),z,d(t("input",{type:"password",placeholder:"密码","onUpdate:modelValue":e[10]||(e[10]=s=>o.form.password=s)},null,512),[[m,o.form.password]]),j,d(t("input",{type:"password",placeholder:"确认密码","onUpdate:modelValue":e[11]||(e[11]=s=>o.form.password2=s)},null,512),[[m,o.form.password2]])]),t("button",{class:"bbutton",onClick:e[12]||(e[12]=(...s)=>l.changeRegState&&l.changeRegState(...s))},"上一步"),u("  "),t("button",{class:"bbutton",onClick:e[13]||(e[13]=(...s)=>l.register&&l.register(...s))},"注册")])):(a(),i("div",U,[V,t("div",R,[d(t("input",{type:"text",placeholder:"学号","onUpdate:modelValue":e[4]||(e[4]=s=>o.form.sid=s)},null,512),[[m,o.form.sid]]),L,o.existed?(a(),i("span",M,"* 该学号已经注册！ *")):p("",!0),d(t("input",{type:"text",placeholder:"姓名","onUpdate:modelValue":e[5]||(e[5]=s=>o.form.name=s)},null,512),[[m,o.form.name]]),N,d(t("input",{type:"text",placeholder:"学院","onUpdate:modelValue":e[6]||(e[6]=s=>o.form.college=s)},null,512),[[m,o.form.college]]),F,d(t("input",{type:"email",placeholder:"邮箱","onUpdate:modelValue":e[7]||(e[7]=s=>o.form.email=s)},null,512),[[m,o.form.email]]),P,u(" 请确认您的个人信息无误。 ")]),t("button",{class:"bbutton",onClick:e[8]||(e[8]=(...s)=>l.changeRegState&&l.changeRegState(...s))},"下一步")]))]))],2),t("div",{class:f(["small-box",{active:o.isLogin}])},[o.isLogin?(a(),i("div",q,[A,G,t("button",{class:"sbutton",onClick:e[14]||(e[14]=(...s)=>l.changeType&&l.changeType(...s))},"前往注册"),H,t("button",{class:"sbutton",onClick:e[15]||(e[15]=(...s)=>l.teacherEntry&&l.teacherEntry(...s))},"教师入口")])):(a(),i("div",J,[K,Q,t("button",{class:"sbutton",onClick:e[16]||(e[16]=(...s)=>l.changeType&&l.changeType(...s))},"前往登录"),W,t("button",{class:"sbutton",onClick:e[17]||(e[17]=(...s)=>l.teacherEntry&&l.teacherEntry(...s))},"教师入口")]))],2)])])}const ee=g(y,[["render",X],["__scopeId","data-v-975f6a26"]]);export{ee as default};
