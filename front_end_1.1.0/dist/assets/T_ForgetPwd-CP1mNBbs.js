import{_ as p,d as u,c as a,e,n as m,b as i,f as d,v as c,h as f,t as _,g,o as h,p as b,i as w}from"./index-BwCKoIWF.js";const y={name:"login-register",data(){return{isLogin:!0,stateReg:!1,emailError:!1,passwordError:!1,existed:!1,form:{email:"",password:"",phone:"",code:""},show:!0,count:"",timer:null}},methods:{studentEntry(){this.$router.push("/studentLogin")},changeType(){this.isLogin=!this.isLogin,this.stateReg=!1,this.form.tid="",this.form.name="",this.form.email="",this.form.password=""},teacherEntry(){this.$router.push("/teacherLogin")},sendCode(){this.timer||(console.log("已发送"),u({method:"post",url:"user/forget/sendCode",data:{acc:this.form.phone}}).then(t=>{alert("验证码已发送，请查看手机消息。")}),this.count=60,this.show=!1,this.timer=setInterval(()=>{this.count>0&&this.count<=60?this.count--:(this.show=!0,clearInterval(this.timer),this.timer=null)},1e3))},changeRegState(){this.form.sid!=""&&this.form.name!=""&&this.form.college!=""?this.stateReg=!this.stateReg:alert("填写不能为空！")},changePwd(){this.form.phone!=""&&this.form.password!=""&&u({method:"post",url:"http://8.130.48.144/forget/setPwd",data:{uid:this.userId,old_pwd:this.form.password,new_pwd:this.new_password}}).then(l=>{switch(l.error_code){case 0:alert("登录成功");break;case 1:alert("请求参数错误");break;case 2:alert("原密码错误");break;case 3:alert("新密码格式错误");break;case 4:alert("用户不存在");break}})},confirmChange(){this.form.email!=""&&this.form.password!=""?u({method:"post",url:"manager/forget/setPwd",data:{acc:this.form.email,phoneNumber:this.form.phone,pwd:this.form.password,key:this.form.code}}).then(l=>{console.log(l.data.error_code),l.data.error_code==0?(alert("重置密码成功！"),this.$router.push("/teacherLogin")):l.data.error_code==1?alert("存在输入为空！"):l.data.error_code==2?alert("该邮箱不存在！"):l.data.error_code==3?alert("密码错误！请重新输入。"):alert("验证码错误，请重新输入。")}):alert("填写不能为空")},register(){console.log(this.form.phone+" : "+this.form.tid),this.form.password!=""&&this.form.email!=""?this.form.password!=this.form.password2?alert("两次密码输入不一致。"):u({method:"post",url:"manager/RegisterTeacherAcc",data:{acc:this.form.email,teacherId:this.form.tid,name:this.form.name,pwd:this.form.password,key:this.form.code,phoneNumber:this.form.phone}}).then(l=>{console.log(l),l.data.error_code==0&&(alert("您的注册请求已提交！请等待管理员审核。"),this.$router.push("/teacherLogin"))}):alert("填写不能为空！")}}},n=l=>(b("data-v-53540579"),l=l(),w(),l),v={class:"login-register"},k=n(()=>e("div",{class:"header"},null,-1)),C={class:"contain"},x={key:0,class:"big-contain"},T=n(()=>e("div",{class:"btitle"},"忘记密码",-1)),E={class:"bform"},I={class:"count"},L=n(()=>e("br",null,null,-1)),U={class:"count"},V=n(()=>e("br",null,null,-1)),R=n(()=>e("br",null,null,-1)),N={class:"count"},S=n(()=>e("br",null,null,-1)),M={class:"count"},P=n(()=>e("br",null,null,-1)),B={style:{"align-items":"center","margin-top":"70px"}},O={key:1,class:"big-contain"},D={key:0},z=n(()=>e("div",{class:"btitle"},"教师注册",-1)),A=n(()=>e("br",null,null,-1)),F={class:"bform"},j=n(()=>e("br",null,null,-1)),q={key:0,class:"errTips"},G=n(()=>e("br",null,null,-1)),H=n(()=>e("br",null,null,-1)),J=n(()=>e("br",null,null,-1)),K={key:1},Q={key:0,class:"small-contain"},W=n(()=>e("div",{class:"stitle"},[i("北航工程训练中心"),e("br"),i("工具信息平台")],-1)),X=n(()=>e("p",{class:"scontent"},[i("请输入您的邮箱"),e("br"),i("或管理员账号")],-1)),Y=n(()=>e("br",null,null,-1)),Z={key:1,class:"small-contain"},$=n(()=>e("div",{class:"stitle"},"老师，您好！",-1)),ee=n(()=>e("p",{class:"scontent"},[i("注册工训中心账号，"),e("br"),i("轻松管理设备借还。")],-1)),te=n(()=>e("br",null,null,-1));function se(l,t,oe,ne,o,r){return h(),a("div",v,[k,e("div",C,[e("div",{class:m(["big-box",{active:o.isLogin}])},[o.isLogin?(h(),a("div",x,[T,e("div",E,[e("span",I,[i("邮箱          :  "),d(e("input",{type:"text",placeholder:"邮箱","onUpdate:modelValue":t[0]||(t[0]=s=>o.form.email=s)},null,512),[[c,o.form.email]])]),L,e("span",U,[i("手机号码    :  "),d(e("input",{type:"text",placeholder:"手机号码","onUpdate:modelValue":t[1]||(t[1]=s=>o.form.phone=s)},null,512),[[c,o.form.phone]])]),V,e("button",{onClick:t[2]||(t[2]=(...s)=>r.sendCode&&r.sendCode(...s))},[i("获取验证码"),d(e("span",{class:"count"},_(o.count)+" s",513),[[f,!o.show]])]),R,e("span",N,[i("验证码       :  "),d(e("input",{type:"code",placeholder:"验证码","onUpdate:modelValue":t[3]||(t[3]=s=>o.form.code=s)},null,512),[[c,o.form.code]])]),S,e("span",M,[i("设置新密码:  "),d(e("input",{type:"password",placeholder:"设置新密码","onUpdate:modelValue":t[4]||(t[4]=s=>o.form.password=s)},null,512),[[c,o.form.password]])]),P]),e("div",B,[e("button",{class:"bbutton",onClick:t[5]||(t[5]=(...s)=>r.confirmChange&&r.confirmChange(...s))},"确认修改"),i("   "),e("button",{onClick:t[6]||(t[6]=(...s)=>r.teacherEntry&&r.teacherEntry(...s))},"返回登录")])])):(h(),a("div",O,[o.stateReg?(h(),a("div",K)):(h(),a("div",D,[z,A,e("div",F,[d(e("input",{type:"text",placeholder:"工号","onUpdate:modelValue":t[7]||(t[7]=s=>o.form.tid=s)},null,512),[[c,o.form.tid]]),j,o.existed?(h(),a("span",q,"* 该工号已经注册！ *")):g("",!0),d(e("input",{type:"text",placeholder:"姓名","onUpdate:modelValue":t[8]||(t[8]=s=>o.form.name=s)},null,512),[[c,o.form.name]]),G,d(e("input",{type:"text",placeholder:"邮箱","onUpdate:modelValue":t[9]||(t[9]=s=>o.form.email=s)},null,512),[[c,o.form.email]]),H]),J,e("button",{class:"bbutton",onClick:t[10]||(t[10]=(...s)=>r.changeRegState&&r.changeRegState(...s))},"下一步")]))]))],2),e("div",{class:m(["small-box",{active:o.isLogin}])},[o.isLogin?(h(),a("div",Q,[W,X,e("button",{class:"sbutton",onClick:t[11]||(t[11]=(...s)=>r.changeType&&r.changeType(...s))},"前往注册"),Y,e("button",{class:"sbutton",onClick:t[12]||(t[12]=(...s)=>r.studentEntry&&r.studentEntry(...s))},"学生入口")])):(h(),a("div",Z,[$,ee,e("button",{class:"sbutton",onClick:t[13]||(t[13]=(...s)=>r.changeType&&r.changeType(...s))},"前往登录"),te,e("button",{class:"sbutton",onClick:t[14]||(t[14]=(...s)=>r.studentEntry&&r.studentEntry(...s))},"学生入口")]))],2)])])}const re=p(y,[["render",se],["__scopeId","data-v-53540579"]]);export{re as default};
