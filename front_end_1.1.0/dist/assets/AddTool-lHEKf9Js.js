import{_ as L,d as b,m as I,c as p,a as l,e as n,j as f,w as a,r as s,o as d,F as T,l as B,g as S,b as _,p as U,i as R}from"./index-BBbOrejx.js";import{T as q}from"./TeacherHeadBar-dz4hO6k4.js";import{T as A}from"./TeacherMenu-Bq3oTJu6.js";import"./headerLogo-CGJBKw5C.js";const F={components:{TeacherHeadBar:q,TeacherMenu:A},data(){return{addSuccess:!1,formLoading:!1,ops:[],form:{labelId:null,name:"",img:"",intro:"暂无简介",addCount:1,imgfile:null,limit_days:7},rules:{name:[{required:!0,message:"请输入工具名称",trigger:"blur"}],labelId:[{required:!0,message:"请选择分类",trigger:"blur"}],img:[{required:!0,message:"请上传工具图片",trigger:"blur"}],addCount:[{required:!0,message:"请输入工具数量",trigger:"blur"}],limit_days:[{required:!0,message:"请输入工具的限制借用天数",trigger:"blur"}],intro:[]}}},mounted(){this.init()},methods:{formReset(){this.form.labelId=null,this.form.name="",this.form.img=null,this.form.intro="暂无简介",this.form.addCount=1,this.form.limit_days=7,this.form.imgfile=null},continueAdd(){this.formReset(),this.addSuccess=!1},init(){b({url:"user/getFirstLabelList",method:"post"}).then(r=>{r.data.error_code==0&&(this.ops=r.data.labelList)})},handleChange(r,e){this.form.img=URL.createObjectURL(r.raw),this.form.imgfile=r.raw},handleSubmitAdd(){this.formLoading||this.$refs.form.validate(r=>{if(r){this.formLoading=!0;var e=new FormData;e.append("name",this.form.name),e.append("label",this.form.labelId),e.append("total_count",this.form.addCount),e.append("intro",this.form.intro),e.append("limit_days",this.form.limit_days),e.append("img",this.form.imgfile),b.post("/tools",e).then(m=>{m.status==201?(this.formLoading=!1,this.$refs.upload.clearFiles(),this.addSuccess=!0):this.$message.error("由于网络安全原因失败，请重试！",m.data.error_code)}).catch(m=>{I({message:"添加工具失败"+m,type:"error"})})}})}}},j=r=>(U("data-v-bf920b3f"),r=r(),R(),r),N={style:{display:"grid","grid-template-columns":"20% 75% 5%"}},H={class:"addtool-frame"},M=j(()=>n("div",{class:"addtool-title"},"新增工具",-1)),z={class:"addtool-content"},E={style:{display:"grid","grid-template-columns":"500px 500px","grid-template-rows":"400px 100px","column-gap":"100px"}},D=["src"],O={key:1,class:"el-icon-plus avatar-uploader-icon"},G={style:{"grid-column-start":"span 2","margin-left":"auto","margin-right":"auto"}};function J(r,e,m,K,o,u){const y=s("TeacherHeadBar"),v=s("TeacherMenu"),g=s("el-input"),i=s("el-form-item"),V=s("el-option"),w=s("el-select"),C=s("el-upload"),h=s("el-input-number"),c=s("el-button"),k=s("el-form"),x=s("el-result");return d(),p("div",null,[l(y),n("div",N,[n("div",null,[l(v)]),n("div",H,[M,n("div",z,[o.addSuccess==!1?(d(),f(k,{key:0,ref:"form",model:o.form,rules:o.rules,"label-width":"80px"},{default:a(()=>[n("div",E,[n("div",null,[l(i,{label:"工具名称",prop:"name"},{default:a(()=>[l(g,{modelValue:o.form.name,"onUpdate:modelValue":e[0]||(e[0]=t=>o.form.name=t),placeholder:"请输入名称"},null,8,["modelValue"])]),_:1}),l(i,{label:"所属分类",prop:"labelId"},{default:a(()=>[l(w,{modelValue:o.form.labelId,"onUpdate:modelValue":e[1]||(e[1]=t=>o.form.labelId=t),placeholder:"选择分类"},{default:a(()=>[(d(!0),p(T,null,B(o.ops,t=>(d(),f(V,{key:t.lowerLabel[0].id,label:t.lowerLabel[0].name,value:t.lowerLabel[0].id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),l(i,{label:"工具图片",prop:"img",ref:"uploadElement"},{default:a(()=>[S("",!0),l(C,{class:"avatar-uploader",ref:"upload",accept:"image/jpeg,image/jpg,image/png","auto-upload":!1,action:"","show-file-list":!1,"on-change":u.handleChange},{default:a(()=>[o.form.img?(d(),p("img",{key:0,src:o.form.img,class:"avatar"},null,8,D)):(d(),p("i",O))]),_:1},8,["on-change"])]),_:1},512),l(i,{label:"工具数量",prop:"addCount"},{default:a(()=>[l(h,{style:{width:"100%"},modelValue:o.form.addCount,"onUpdate:modelValue":e[3]||(e[3]=t=>o.form.addCount=t),min:1},null,8,["modelValue"])]),_:1})]),n("div",null,[l(i,{label:"限借天数",prop:"limit_days"},{default:a(()=>[l(h,{style:{width:"100%"},modelValue:o.form.limit_days,"onUpdate:modelValue":e[4]||(e[4]=t=>o.form.limit_days=t),min:1},null,8,["modelValue"])]),_:1}),l(i,{label:"工具详情",prop:"intro"},{default:a(()=>[l(g,{type:"textarea",autosize:{minRows:14},placeholder:"请输入内容",modelValue:o.form.intro,"onUpdate:modelValue":e[5]||(e[5]=t=>o.form.intro=t)},null,8,["modelValue"])]),_:1})]),n("div",G,[l(i,null,{default:a(()=>[l(c,{style:{width:"200px"},type:"warning",onClick:u.handleSubmitAdd,loading:o.formLoading},{default:a(()=>[_("确定")]),_:1},8,["onClick","loading"]),l(c,{style:{width:"200px"},onClick:u.formReset},{default:a(()=>[_("清空")]),_:1},8,["onClick"])]),_:1})])])]),_:1},8,["model","rules"])):(d(),f(x,{key:1,icon:"success",title:"添加工具成功"},{extra:a(()=>[l(c,{type:"primary",size:"medium",onClick:u.continueAdd},{default:a(()=>[_("继续添加")]),_:1},8,["onClick"])]),_:1}))])])])])}const Y=L(F,[["render",J],["__scopeId","data-v-bf920b3f"]]);export{Y as default};
