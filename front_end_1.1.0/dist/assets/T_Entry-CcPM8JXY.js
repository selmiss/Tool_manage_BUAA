import{_ as g,a as u,c as n,b as t,n as f,w as d,v as c,d as p,e as m,t as _,o as a,p as b,g as w}from"./index-B3rJzjPI.js";const y={name:"login-register",data(){return{isLogin:!0,stateReg:!1,emailError:!1,passwordError:!1,existed:!1,form:{name:"",tid:"",email:"",password:"",password2:"",phone:""},show:!0,count:"",timer:null}},methods:{studentEntry(){this.$router.push("/studentLogin")},changeType(){this.isLogin=!this.isLogin,this.stateReg=!1,this.form.tid="",this.form.name="",this.form.email="",this.form.password=""},teacherForgetPwd(){this.$router.push("/teacherForgetPwd")},sendCode(){this.timer||(console.log("已发送"),u({method:"post",url:"user/forget/sendCode",data:{acc:this.form.phone}}).then(e=>{console.log(e.error_code),alert("验证码已发送，请在手机信息中查看。")}),this.count=60,this.show=!1,this.timer=setInterval(()=>{this.count>0&&this.count<=60?this.count--:(this.show=!0,clearInterval(this.timer),this.timer=null)},1e3))},changeRegState(){this.form.sid!=""&&this.form.name!=""&&this.form.college!=""?this.stateReg=!this.stateReg:alert("填写不能为空！")},changePwd(){this.form.email!=""&&this.form.password!=""&&u({method:"post",url:"manager/resetPwd",data:{uid:this.userId,old_pwd:this.form.password,new_pwd:this.new_password}}).then(i=>{switch(i.error_code){case 0:alert("登录成功");break;case 1:alert("请求参数错误");break;case 2:alert("原密码错误");break;case 3:alert("新密码格式错误");break;case 4:alert("用户不存在");break}})},login(){localStorage.setItem("token","wutoken");var i=localStorage.getItem("token");console.log(i),this.form.email!=""&&this.form.password!=""?u.post("manager/Login",{acc:this.form.email,pwd:this.form.password}).then(e=>{console.log(u.defaults.baseURL);let h={};h.Mail=this.form.email,h.UID=e.data.uid,h.hash_code=e.data.hash_code,console.log(h.hash_code),e.data.error_code==0?(localStorage.setItem("uid",e.data.uid),localStorage.setItem("Mail",this.form.email),localStorage.setItem("isSuperUser",e.data.is_superUser),localStorage.setItem("token",e.data.hash_code),e.data.is_superUser?(this.$router.push("/borrowProcessing"),this.$store.commit("changeLogin",h)):(this.$router.push("/settools"),this.$store.commit("changeLogin",h))):e.data.error_code==1?alert("存在输入为空！"):e.data.error_code==2?alert("用户不存在！"):e.data.error_code==3?alert("密码错误！请重新输入。"):alert("请重新输入！")}):alert("填写不能为空")},register(){console.log(this.form.phone+" : "+this.form.tid),this.form.password!=""&&this.form.email!=""?this.form.password!=this.form.password2?alert("两次密码输入不一致。"):u({method:"post",url:"manager/RegisterTeacherAcc",data:{acc:this.form.email,teacherId:this.form.tid,name:this.form.name,pwd:this.form.password,phoneNumber:this.form.phone}}).then(i=>{console.log(i),i.data.error_code==0&&(alert("您的注册请求已提交！请等待管理员审核。"),this.changeType()),i.data.error_code==1&&alert("输入有误！请检查并重新输入"),i.data.error_code==2&&alert("该邮箱已注册！")}):alert("填写不能为空！")}}},l=i=>(b("data-v-56c8e9c9"),i=i(),w(),i),k={class:"login-register"},v=l(()=>t("div",{class:"header"},null,-1)),T={class:"contain"},I={key:0,class:"big-contain"},C=l(()=>t("div",{class:"btitle"},"教师登录",-1)),S={class:"bform"},U={key:0,class:"errTips"},x={key:1,class:"errTips"},E={key:1,class:"big-contain"},L={key:0},R=l(()=>t("div",{class:"btitle"},"教师注册",-1)),V=l(()=>t("br",null,null,-1)),N={class:"bform"},P=l(()=>t("br",null,null,-1)),M={key:0,class:"errTips"},F=l(()=>t("br",null,null,-1)),B=l(()=>t("br",null,null,-1)),D=l(()=>t("br",null,null,-1)),O={key:1},z={class:"btitle"},A={class:"bform"},j=l(()=>t("br",null,null,-1)),q=l(()=>t("br",null,null,-1)),G={key:0,class:"small-contain"},H=l(()=>t("div",{class:"stitle"},[m("北航工程训练中心"),t("br"),m("工具信息平台")],-1)),J=l(()=>t("p",{class:"scontent"},[m("请输入您的邮箱"),t("br"),m("或管理员账号")],-1)),K=l(()=>t("br",null,null,-1)),Q={key:1,class:"small-contain"},W=l(()=>t("div",{class:"stitle"},"老师，您好！",-1)),X=l(()=>t("p",{class:"scontent"},[m("注册工训中心账号，"),t("br"),m("轻松管理设备借还。")],-1)),Y=l(()=>t("br",null,null,-1));function Z(i,e,h,$,o,r){return a(),n("div",k,[v,t("div",T,[t("div",{class:f(["big-box",{active:o.isLogin}])},[o.isLogin?(a(),n("div",I,[C,t("div",S,[d(t("input",{type:"email",placeholder:"邮箱","onUpdate:modelValue":e[0]||(e[0]=s=>o.form.email=s)},null,512),[[c,o.form.email]]),o.emailError?(a(),n("span",U,"* 邮箱填写错误 *")):p("",!0),d(t("input",{type:"password",placeholder:"密码","onUpdate:modelValue":e[1]||(e[1]=s=>o.form.password=s)},null,512),[[c,o.form.password]]),o.emailError?(a(),n("span",x,"* 密码填写错误 *")):p("",!0)]),t("button",{class:"bbutton",onClick:e[2]||(e[2]=(...s)=>r.login&&r.login(...s))},"登录"),m("   "),t("button",{class:"bbutton",onClick:e[3]||(e[3]=(...s)=>r.teacherForgetPwd&&r.teacherForgetPwd(...s))},"忘记密码")])):(a(),n("div",E,[o.stateReg?(a(),n("div",O,[t("div",z,"欢迎，"+_(this.form.name)+"老师！",1),t("div",A,[d(t("input",{type:"text",placeholder:"手机号","onUpdate:modelValue":e[8]||(e[8]=s=>o.form.phone=s)},null,512),[[c,o.form.phone]]),j,d(t("input",{type:"password",placeholder:"密码","onUpdate:modelValue":e[9]||(e[9]=s=>o.form.password=s)},null,512),[[c,o.form.password]]),q,d(t("input",{type:"password",placeholder:"确认密码","onUpdate:modelValue":e[10]||(e[10]=s=>o.form.password2=s)},null,512),[[c,o.form.password2]])]),t("button",{class:"bbutton",onClick:e[11]||(e[11]=(...s)=>r.changeRegState&&r.changeRegState(...s))},"上一步"),m("  "),t("button",{class:"bbutton",onClick:e[12]||(e[12]=(...s)=>r.register&&r.register(...s))},"注册")])):(a(),n("div",L,[R,V,t("div",N,[d(t("input",{type:"text",placeholder:"工号","onUpdate:modelValue":e[4]||(e[4]=s=>o.form.tid=s)},null,512),[[c,o.form.tid]]),P,o.existed?(a(),n("span",M,"* 该工号已经注册！ *")):p("",!0),d(t("input",{type:"text",placeholder:"姓名","onUpdate:modelValue":e[5]||(e[5]=s=>o.form.name=s)},null,512),[[c,o.form.name]]),F,d(t("input",{type:"text",placeholder:"邮箱","onUpdate:modelValue":e[6]||(e[6]=s=>o.form.email=s)},null,512),[[c,o.form.email]]),B]),D,t("button",{class:"bbutton",onClick:e[7]||(e[7]=(...s)=>r.changeRegState&&r.changeRegState(...s))},"下一步")]))]))],2),t("div",{class:f(["small-box",{active:o.isLogin}])},[o.isLogin?(a(),n("div",G,[H,J,t("button",{class:"sbutton",onClick:e[13]||(e[13]=(...s)=>r.changeType&&r.changeType(...s))},"前往注册"),K,t("button",{class:"sbutton",onClick:e[14]||(e[14]=(...s)=>r.studentEntry&&r.studentEntry(...s))},"学生入口")])):(a(),n("div",Q,[W,X,t("button",{class:"sbutton",onClick:e[15]||(e[15]=(...s)=>r.changeType&&r.changeType(...s))},"前往登录"),Y,t("button",{class:"sbutton",onClick:e[16]||(e[16]=(...s)=>r.studentEntry&&r.studentEntry(...s))},"学生入口")]))],2)])])}const te=g(y,[["render",Z],["__scopeId","data-v-56c8e9c9"]]);export{te as default};
