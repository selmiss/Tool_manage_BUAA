import{_ as q,d as p,c as I,a as t,w as o,r as a,o as N,e as n,t as d,b as c,p as k,i as P}from"./index-CIIbYJoP.js";import{T as D}from"./TeacherHeadBar-DcQerhYF.js";import{T as B}from"./TeacherMenu-32CuamBo.js";import"./headerLogo-CGJBKw5C.js";const F={inject:["reload"],components:{TeacherHeadBar:D,TeacherMenu:B},mounted(){this.loadMessage()},data(){return{dialogFormVisible:!1,formData:{refuseReason:""},renewList:[{toolName:"",requestUserName:"",startTime:"",borrowTime:"",returnTime:"",postPoneTime:"",stuid:"",stuCollege:"",userId:"",phoneNumber:"",stuEmail:"",postponePurpose:"",requestId:""}]}},methods:{handleCreate(){this.formData={refuseReason:""},this.dialogFormVisible=!0},handleAgree(l){p({url:"manager/approvePostponeRequest",method:"post",data:{requestId:l.requestId,status:"Accept",refuseReason:""}}).then(e=>{e?e.data.error_code===0?(alert("已同意延期申请，该设备最晚于"+l.postPoneTime+"归还"),this.reload()):(console.log("error"+e.data.error_code),alert("error"+e.data.error_code)):(console.log("审批失败，请检查网络"),alert("审批失败，请检查网络"))})},handleRefuse(l){p({url:"manager/approvePostponeRequest",method:"post",data:{requestId:l.requestId,status:"Refuse",refuseReason:this.formData.refuseReason}}).then(e=>{e?e.data.error_code===0?(console.log("已拒绝该申请",e.data),alert("已拒绝该申请"),this.reload()):(console.log("error"+e.data.error_code),alert("error"+e.data.error_code)):(console.log("审批失败，请检查网络"),alert("审批失败，请检查网络"))})},loadMessage(){let l=this;p({url:"manager/getPostponeRequestList",method:"post",data:{}}).then(e=>{e&&e.data.error_code===0?(console.log("获取成功",e.data),l.renewList=e.data.data_list):(console.log("获取失败"+e.data),alert("获取失败，请检查网络"))})}}},M=l=>(k("data-v-f69a5bb4"),l=l(),P(),l),U=M(()=>n("div",{class:"title"},"待审批延期归还申请",-1)),z={style:{margin:"0 auto","margin-top":"20px","align-items":"center"}},L={slot:"footer",class:"dialog-footer"};function S(l,e,A,E,i,_){const g=a("TeacherHeadBar"),b=a("TeacherMenu"),f=a("el-aside"),m=a("el-table-column"),u=a("el-button"),h=a("el-popover"),w=a("el-input"),v=a("el-form-item"),T=a("el-form"),x=a("el-dialog"),y=a("el-table"),V=a("el-card"),R=a("el-main"),C=a("el-container");return N(),I("div",null,[t(g),t(C,null,{default:o(()=>[t(f,{width:"20%",style:{"min-height":"600px"}},{default:o(()=>[t(b)]),_:1}),t(R,{width:"75%"},{default:o(()=>[U,n("div",z,[t(V,{class:"box-card",style:{width:"100%"}},{default:o(()=>[t(y,{data:i.renewList,style:{width:"100%"},border:""},{default:o(()=>[t(m,{align:"center",prop:"toolName",label:"工具名称","min-width":"100"}),t(m,{align:"center",label:"借用者信息","min-width":"100"},{default:o(r=>[t(h,{trigger:"hover",placement:"bottom",width:"250"},{default:o(()=>[n("div",null,d(r.row.requestUserName)+"       "+d(r.row.stuid),1),n("div",null,"学院:         "+d(r.row.stuCollege),1),n("div",null,"联系邮箱:  "+d(r.row.stuEmail),1),n("div",null,"联系电话:  "+d(r.row.phoneNumber),1)]),reference:o(()=>[t(u,{size:"mini",slot:"reference"},{default:o(()=>[c(d(r.row.requestUserName),1)]),_:2},1024)]),_:2},1024)]),_:1}),t(m,{align:"center",prop:"startTime",label:"借用开始时间","min-width":"100"}),t(m,{align:"center",prop:"returnTime",label:"原定归还时间","min-width":"100"}),t(m,{align:"center",prop:"postPoneTime",label:"延期归还时间","min-width":"100"}),t(m,{align:"center",label:"操作","min-width":"200"},{default:o(r=>[t(h,{trigger:"click",placement:"left",width:"250"},{default:o(()=>[n("div",null,"延期目的: "+d(r.row.postponePurpose),1)]),reference:o(()=>[t(u,{style:{"margin-right":"10px"},size:"mini",plain:"",slot:"reference",type:"primary"},{default:o(()=>[c("查看")]),_:1})]),_:2},1024),t(u,{size:"mini",type:"success",plain:"",onClick:s=>_.handleAgree(r.row)},{default:o(()=>[c("同意")]),_:2},1032,["onClick"]),t(u,{size:"mini",type:"danger",plain:"",onClick:e[0]||(e[0]=s=>_.handleCreate())},{default:o(()=>[c("拒绝")]),_:1}),t(x,{modelValue:i.dialogFormVisible,"onUpdate:modelValue":e[3]||(e[3]=s=>i.dialogFormVisible=s)},{default:o(()=>[t(T,{model:i.formData,ref:"dataForm","label-position":"left","label-width":"80px",style:{width:"300px","margin-left":"50px"}},{default:o(()=>[t(v,{label:"拒绝原因"},{default:o(()=>[t(w,{type:"textarea",rows:2,modelValue:i.formData.refuseReason,"onUpdate:modelValue":e[1]||(e[1]=s=>i.formData.refuseReason=s),placeholder:"请输入拒绝原因"},null,8,["modelValue"])]),_:1})]),_:1},8,["model"]),n("div",L,[t(u,{onClick:e[2]||(e[2]=s=>i.dialogFormVisible=!1)},{default:o(()=>[c("取消")]),_:1}),t(u,{type:"primary",onClick:s=>_.handleRefuse(r.row)},{default:o(()=>[c("确定")]),_:2},1032,["onClick"])])]),_:2},1032,["modelValue"])]),_:1})]),_:1},8,["data"])]),_:1})])]),_:1}),t(f,{width:"5%"})]),_:1})])}const K=q(F,[["render",S],["__scopeId","data-v-f69a5bb4"]]);export{K as default};
