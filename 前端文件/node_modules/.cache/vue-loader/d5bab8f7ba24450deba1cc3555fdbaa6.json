{"remainingRequest":"D:\\Desktop\\git_clong\\Tool_manage_BUAA\\前端文件\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\Desktop\\git_clong\\Tool_manage_BUAA\\前端文件\\src\\views\\Manage\\AddTool.vue?vue&type=style&index=0&id=7a8e0c49&scoped=true&lang=css&","dependencies":[{"path":"D:\\Desktop\\git_clong\\Tool_manage_BUAA\\前端文件\\src\\views\\Manage\\AddTool.vue","mtime":1673541191727},{"path":"D:\\Desktop\\git_clong\\Tool_manage_BUAA\\前端文件\\node_modules\\css-loader\\dist\\cjs.js","mtime":1672919903236},{"path":"D:\\Desktop\\git_clong\\Tool_manage_BUAA\\前端文件\\node_modules\\vue-loader\\lib\\loaders\\stylePostLoader.js","mtime":1672919906189},{"path":"D:\\Desktop\\git_clong\\Tool_manage_BUAA\\前端文件\\node_modules\\postcss-loader\\src\\index.js","mtime":1672919905146},{"path":"D:\\Desktop\\git_clong\\Tool_manage_BUAA\\前端文件\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1672919902432},{"path":"D:\\Desktop\\git_clong\\Tool_manage_BUAA\\前端文件\\node_modules\\vue-loader\\lib\\index.js","mtime":1672919906189}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKDQouYWRkdG9vbC10aXRsZXsNCiAgZm9udC13ZWlnaHQ6IGJvbGQ7DQogIGZvbnQtc2l6ZTogMmVtOw0KICBjb2xvcjogI2Q1OTEzMTsNCn0NCg0KaW5wdXRbdHlwZT0iZmlsZSJdIHsNCiAgZGlzcGxheTogbm9uZTsNCn0NCg0KLmF2YXRhci11cGxvYWRlcnsNCiAgYm9yZGVyOiAxcHggZGFzaGVkICNjMGM0Y2M7DQogIHdpZHRoOiAyMDBweDsNCiAgaGVpZ2h0OiAyMDBweDsNCiAgbWFyZ2luOiAwIGF1dG87DQogIGJvcmRlci1yYWRpdXM6IDZweDsNCiAgY3Vyc29yOiBwb2ludGVyOw0KICBwb3NpdGlvbjogcmVsYXRpdmU7DQogIG92ZXJmbG93OiBoaWRkZW47DQp9DQoNCi5hdmF0YXItdXBsb2FkZXIgOmhvdmVyIHsNCiAgYm9yZGVyLWNvbG9yOiAjNDA5RUZGOw0KfQ0KDQouYXZhdGFyLXVwbG9hZGVyLWljb24gew0KICBmb250LXNpemU6IDI4cHg7DQogIGNvbG9yOiAjOGM5MzlkOw0KICB3aWR0aDogMjAwcHg7DQogIGhlaWdodDogMjAwcHg7DQogIGxpbmUtaGVpZ2h0OiAyMDBweDsNCiAgdGV4dC1hbGlnbjogY2VudGVyOw0KfQ0KDQouYXZhdGFyIHsNCiAgd2lkdGg6IDE3OHB4Ow0KICBoZWlnaHQ6IDE3OHB4Ow0KICBkaXNwbGF5OiBibG9jazsNCn0NCi5hZGR0b29sLWZyYW1lew0KICB3aWR0aDogMTAwJTsNCiAgZGlzcGxheTogZ3JpZDsNCiAgZ3JpZC10ZW1wbGF0ZS1yb3dzOjEwMHB4IGF1dG8gMTAwcHg7DQogIHJvdy1nYXA6IDIwcHg7DQogIGp1c3RpZnktaXRlbXM6IGNlbnRlcjsNCiAgYWxpZ24taXRlbXM6IGNlbnRlcjsNCiAgYWxpZ24tY29udGVudDogc3RyZXRjaDsNCiAganVzdGlmeS1jb250ZW50OiBzdHJldGNoOw0KfQ0KLmFkZHRvb2wtY29udGVudHsNCiAgd2lkdGg6IDEwMCU7DQp9DQo="},{"version":3,"sources":["AddTool.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA0MA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"AddTool.vue","sourceRoot":"src/views/Manage","sourcesContent":["<template>\r\n  <div>\r\n    <TeacherHeadBar></TeacherHeadBar>\r\n    <div style=\"display: grid;grid-template-columns: 20% 75% 5%;\">\r\n      <div><TeacherMenu></TeacherMenu></div>\r\n      <div  class=\"addtool-frame\">\r\n        <div class=\"addtool-title\">新增工具</div>\r\n        <div class=\"addtool-content\">\r\n          <el-form v-if=\"addSuccess==false\" ref=\"form\" :model=\"form\" :rules=\"rules\" label-width=\"80px\">\r\n            <div style=\"display: grid;grid-template-columns: 500px 500px;grid-template-rows:400px 100px;column-gap: 100px;\">\r\n              <div>\r\n                <el-form-item label=\"工具名称\" prop=\"name\">\r\n                  <el-input v-model=\"form.name\"></el-input>\r\n                </el-form-item>\r\n                <el-form-item label=\"所属分类\" prop=\"labelId\">\r\n                  <el-select v-model=\"form.labelId\" placeholder=\"选择分类\">\r\n                    <el-option\r\n                        v-for=\"op in ops\"\r\n                        :key=\"op.lowerLabel[0].id\"\r\n                        :label=\"op.lowerLabel[0].name\"\r\n                        :value=\"op.lowerLabel[0].id\"\r\n                    ></el-option>\r\n                  </el-select>\r\n                </el-form-item>\r\n                <el-form-item label=\"工具图片\" prop=\"img\" ref=\"uploadElement\">\r\n                  <el-input v-model=\"form.img\" v-if=\"false\"></el-input>\r\n                  <el-upload\r\n                      class=\"avatar-uploader\" ref=\"upload\"\r\n                      accept=\"image/jpeg,image/jpg,image/png\"\r\n                      :auto-upload=\"false\" action=\"\"\r\n                      :show-file-list=\"false\"\r\n                      :on-change=\"handleChange\"\r\n                      :on-success=\"handleAvatarSuccess\">\r\n                    <img v-if=\"form.img\" :src=\"form.img\" class=\"avatar\">\r\n                    <i v-else class=\"el-icon-plus avatar-uploader-icon\"></i>\r\n                  </el-upload>\r\n                </el-form-item>\r\n                <el-form-item label=\"工具数量\"  prop=\"addCount\">\r\n                  <el-input-number style=\"width: 100%\" v-model=\"form.addCount\" :min=\"1\"></el-input-number>\r\n                </el-form-item>\r\n\r\n              </div>\r\n              <div>\r\n                <el-form-item label=\"限借天数\" prop=\"limit_days\">\r\n                  <el-input-number style=\"width: 100%\" v-model=\"form.limit_days\" :min=\"1\"></el-input-number>\r\n                </el-form-item>\r\n                <el-form-item label=\"工具详情\" prop=\"intro\">\r\n                <el-input\r\n                    type=\"textarea\"\r\n                    :autosize=\"{minRows:14}\"\r\n                    placeholder=\"请输入内容\"\r\n                    v-model=\"form.intro\">\r\n                </el-input>\r\n              </el-form-item>\r\n              </div>\r\n              <div style=\"grid-column-start: span 2;\">\r\n                <el-form-item>\r\n                  <el-button style=\"width: 200px;font-size: 1.2em;background-color: #d59131;color:#fff\" @click=\"handleSubmitAdd\" :loading=\"formLoading\">确定</el-button>\r\n                  <el-button style=\"width: 200px;font-size: 1.2em\" @click=\"formReset\">清空</el-button>\r\n                </el-form-item>\r\n              </div>\r\n\r\n            </div>\r\n          </el-form>\r\n          <el-result v-else icon=\"success\" title=\"添加工具成功\" >\r\n            <template slot=\"extra\">\r\n              <el-button type=\"primary\" size=\"medium\" @click=\"continueAdd\">继续添加</el-button>\r\n            </template>\r\n          </el-result>\r\n        </div>\r\n        <div></div>\r\n      </div>\r\n      <div></div>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport axios from \"axios\";\r\nimport TeacherHeadBar from \"@/components/TeacherHeadBar\";\r\nimport TeacherMenu from \"@/components/TeacherMenu\";\r\nexport default {\r\n  components:{TeacherHeadBar,TeacherMenu},\r\n  data() {\r\n    return {\r\n      addSuccess:false,\r\n      formLoading:false,\r\n      ops:[],\r\n      uploadFile:'',\r\n      form:{\r\n        labelId:null,\r\n        name:'',\r\n        img:'',\r\n        intro:'',\r\n        addCount:'',\r\n        imgfile:null,\r\n        limit_days:7,\r\n      },\r\n      rules: {\r\n        name: [\r\n          {required: true, message: '请输入工具名称', trigger: 'blur'},\r\n        ],\r\n        labelId:[\r\n          {required: true, message: '请选择分类', trigger: 'blur'},\r\n        ],\r\n        img:[\r\n          {required: true, message: '请上传工具图片', trigger: 'blur'},\r\n        ],\r\n        addCount:[\r\n          {required: true, message: '请输入工具数量', trigger: 'blur'},\r\n        ],\r\n        limit_days:[\r\n          {required: true, message: '请输入工具的限制借用天数', trigger: 'blur'},\r\n        ],\r\n        intro:[\r\n          // {required: true, message: '请输入工具详情', trigger: 'blur'},\r\n        ],\r\n      },\r\n\r\n    };\r\n  },\r\n  mounted() {\r\n    this.init();\r\n  },\r\n  methods: {\r\n    formReset(){\r\n      this.form.labelId=null;\r\n      this.form.name='';\r\n      this.form.img=null;\r\n      this.form.intro='';\r\n      this.form.addCount=null;\r\n      this.form.limit_days=7;\r\n      this.form.imgfile=null;\r\n    },\r\n    continueAdd(){\r\n      this.formReset();\r\n      this.addSuccess=false;\r\n    },\r\n    init(){\r\n      axios({\r\n        url:'user/getFirstLabelList',\r\n        method:'post',\r\n        data:{}\r\n      }).then(res=>{\r\n        if(res.data.error_code==0){\r\n\r\n          this.ops=res.data.labelList;\r\n          console.log(this.ops)\r\n        }\r\n      })\r\n    },\r\n    handleChange (file, fileList) {\r\n      this.form.img = URL.createObjectURL(file.raw);\r\n      this.form.imgfile=file.raw;\r\n    },\r\n    handleAvatarSuccess(){\r\n      axios({\r\n        url:'user/getLabelToolList',\r\n        method:'post',\r\n        data:{\r\n          labelId:this.form.labelId\r\n        }\r\n      }).then(res=>{\r\n        this.init();\r\n      })\r\n    },\r\n    handleSubmitAdd(){\r\n      if(this.formLoading){return}\r\n      this.$refs.form.validate(valid=>{\r\n        if(!valid){return}\r\n        this.formLoading=true;\r\n\r\n        var formdata = new FormData();\r\n        formdata.append(\"name\", this.form.name);\r\n        formdata.append(\"LabelId\", this.form.labelId);\r\n        formdata.append(\"intro\", this.form.intro);\r\n        formdata.append(\"addCount\", this.form.addCount);\r\n        formdata.append(\"uid\", this.$store.state.UID);\r\n        formdata.append(\"limit_days\", this.form.limit_days);\r\n        formdata.append(\"img\", this.form.imgfile);\r\n        axios({\r\n          url:'http://127.0.0.1:8000/manager/createTool',\r\n          method:'post',\r\n          data:formdata,\r\n        }).then(res=>{\r\n          if(res.data.error_code==0){\r\n            this.formLoading = false\r\n            this.$refs.upload.clearFiles();\r\n            this.addSuccess=true;\r\n          }else{\r\n            this.$message.error(\"错误代码：\",res.data.error_code);\r\n          }\r\n        }).catch(err=>{\r\n          this.$message.error(err)\r\n        })\r\n      })\r\n    },\r\n  }\r\n}\r\n</script>\r\n\r\n<style scoped>\r\n.addtool-title{\r\n  font-weight: bold;\r\n  font-size: 2em;\r\n  color: #d59131;\r\n}\r\n\r\ninput[type=\"file\"] {\r\n  display: none;\r\n}\r\n\r\n.avatar-uploader{\r\n  border: 1px dashed #c0c4cc;\r\n  width: 200px;\r\n  height: 200px;\r\n  margin: 0 auto;\r\n  border-radius: 6px;\r\n  cursor: pointer;\r\n  position: relative;\r\n  overflow: hidden;\r\n}\r\n\r\n.avatar-uploader :hover {\r\n  border-color: #409EFF;\r\n}\r\n\r\n.avatar-uploader-icon {\r\n  font-size: 28px;\r\n  color: #8c939d;\r\n  width: 200px;\r\n  height: 200px;\r\n  line-height: 200px;\r\n  text-align: center;\r\n}\r\n\r\n.avatar {\r\n  width: 178px;\r\n  height: 178px;\r\n  display: block;\r\n}\r\n.addtool-frame{\r\n  width: 100%;\r\n  display: grid;\r\n  grid-template-rows:100px auto 100px;\r\n  row-gap: 20px;\r\n  justify-items: center;\r\n  align-items: center;\r\n  align-content: stretch;\r\n  justify-content: stretch;\r\n}\r\n.addtool-content{\r\n  width: 100%;\r\n}\r\n</style>"]}]}